<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <link rel="stylesheet" href="payment.css">
</head>
<body>
    <div class="container payment-container">
        <!-- Header -->
        <header class="text-center mb-4">
            <h2 class="mb-1">Checkout</h2>
            <p class="text-muted">Complete your purchase</p>
        </header>
        
        <!-- Step Indicator -->
        <div class="step-indicator">
            <div class="step completed">
                <div class="step-number">
                    <i class="fas fa-check"></i>
                </div>
                <div class="step-title">Cart</div>
                <div class="step-line"></div>
            </div>
            <div class="step active">
                <div class="step-number">2</div>
                <div class="step-title">Payment</div>
                <div class="step-line"></div>
            </div>
            <div class="step">
                <div class="step-number">3</div>
                <div class="step-title">Confirmation</div>
            </div>
        </div>
        
        <div class="row" id="payment-form">
            <!-- Left Column - Shipping Details -->
            <div class="col-lg-7">
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0">Shipping Details</h5>
                    </div>
                    <div class="card-body">
                        <form id="shipping-form">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <div class="form-floating mb-3">
                                        <input type="text" class="form-control" id="firstName" placeholder="First Name" required>
                                        <label for="firstName">First Name</label>
                                        <div class="invalid-feedback">Please enter your first name</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating mb-3">
                                        <input type="text" class="form-control" id="lastName" placeholder="Last Name" required>
                                        <label for="lastName">Last Name</label>
                                        <div class="invalid-feedback">Please enter your last name</div>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-floating mb-3">
                                        <input type="email" class="form-control" id="email" placeholder="Email" required>
                                        <label for="email">Email Address</label>
                                        <div class="invalid-feedback">Please enter a valid email address</div>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-floating mb-3">
                                        <input type="tel" class="form-control" id="phone" placeholder="Phone" required>
                                        <label for="phone">Phone Number</label>
                                        <div class="invalid-feedback">Please enter a valid phone number</div>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-floating mb-3">
                                        <input type="text" class="form-control" id="address" placeholder="Address" required>
                                        <label for="address">Street Address</label>
                                        <div class="invalid-feedback">Please enter your street address</div>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-floating mb-3">
                                        <input type="text" class="form-control" id="addressLine2" placeholder="Address Line 2">
                                        <label for="addressLine2">Apartment, Suite, etc. (optional)</label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating mb-3">
                                        <input type="text" class="form-control" id="city" placeholder="City" required>
                                        <label for="city">City</label>
                                        <div class="invalid-feedback">Please enter your city</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating mb-3">
                                        <select class="form-select" id="governorate" required>
                                            <option value="" selected disabled>Select Governorate</option>
                                            <option value="Cairo">Cairo</option>
                                            <option value="Alexandria">Alexandria</option>
                                            <option value="Giza">Giza</option>
                                            <option value="Sharm El Sheikh">Sharm El Sheikh</option>
                                            <option value="Luxor">Luxor</option>
                                            <option value="Aswan">Aswan</option>
                                            <option value="Hurghada">Hurghada</option>
                                            <option value="Port Said">Port Said</option>
                                            <option value="Suez">Suez</option>
                                            <option value="Ismailia">Ismailia</option>
                                        </select>
                                        <label for="governorate">Governorate</label>
                                        <div class="invalid-feedback">Please select your governorate</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating mb-3">
                                        <input type="text" class="form-control" id="postalCode" placeholder="Postal Code">
                                        <label for="postalCode">Postal Code (optional)</label>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- Payment Options -->
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Payment Method</h5>
                    </div>
                    <div class="card-body">
                        <div class="secure-badge">
                            <i class="fas fa-lock me-2"></i> All transactions are secure and encrypted
                        </div>
                        
                        <div class="payment-option selected" data-payment="cod">
                            <div class="d-flex align-items-center">
                                <input type="radio" name="payment" id="cod" value="cod" checked class="me-2">
                                <label for="cod" class="mb-0 d-flex align-items-center flex-grow-1">
                                    <i class="fas fa-money-bill-wave payment-icon"></i>
                                    <div>
                                        <strong>Cash on Delivery (COD)</strong>
                                        <p class="text-muted mb-0 small">Pay when you receive your order</p>
                                    </div>
                                </label>
                            </div>
                        </div>
                        
                        <div class="payment-option" data-payment="stripe">
                            <div class="d-flex align-items-center">
                                <input type="radio" name="payment" id="stripe" value="stripe" class="me-2">
                                <label for="stripe" class="mb-0 d-flex align-items-center flex-grow-1">
                                    <i class="fas fa-credit-card payment-icon"></i>
                                    <div>
                                        <strong>Credit / Debit Card</strong>
                                        <p class="text-muted mb-0 small">Pay securely with Stripe</p>
                                    </div>
                                </label>
                            </div>
                            
                            <div id="stripe-details" class="mt-3" style="display: none;">
                                <div class="row g-3">
                                    <div class="col-12">
                                        <label class="form-label">Card Information</label>
                                        <div id="card-element" class="form-control" style="height: 40px; padding-top: 10px;">
                                            <!-- Stripe Card Element will be inserted here -->
                                        </div>
                                        <div id="card-errors" class="invalid-feedback" style="display: none;"></div>
                                    </div>
                                    <div class="col-12">
                                        <div class="form-floating mb-3">
                                            <input type="text" class="form-control" id="cardName" placeholder="Name on Card">
                                            <label for="cardName">Name on Card</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Right Column - Order Summary -->
            <div class="col-lg-5">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Order Summary</h5>
                    </div>
                    <div class="card-body">
                        <!-- Cart Items -->
                        <div class="cart-items">
                            <div class="cart-item d-flex align-items-center mb-3 pb-3 border-bottom">
                                <img src="/api/placeholder/80/80" alt="Product" class="product-img me-3">
                                <div class="flex-grow-1">
                                    <h6 class="mb-0">Premium Cotton T-Shirt</h6>
                                    <p class="text-muted mb-0 small">Size: Medium | Color: Black</p>
                                    <div class="d-flex align-items-center mt-1">
                                        <span class="text-muted me-2">Qty: 2</span>
                                        <span class="fw-bold">EGP 599.00</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="cart-item d-flex align-items-center mb-3 pb-3 border-bottom">
                                <img src="/api/placeholder/80/80" alt="Product" class="product-img me-3">
                                <div class="flex-grow-1">
                                    <h6 class="mb-0">Slim Fit Jeans</h6>
                                    <p class="text-muted mb-0 small">Size: 32 | Color: Blue</p>
                                    <div class="d-flex align-items-center mt-1">
                                        <span class="text-muted me-2">Qty: 1</span>
                                        <span class="fw-bold">EGP 899.00</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="cart-item d-flex align-items-center mb-3">
                                <img src="/api/placeholder/80/80" alt="Product" class="product-img me-3">
                                <div class="flex-grow-1">
                                    <h6 class="mb-0">Canvas Sneakers</h6>
                                    <p class="text-muted mb-0 small">Size: 42 | Color: White</p>
                                    <div class="d-flex align-items-center mt-1">
                                        <span class="text-muted me-2">Qty: 1</span>
                                        <span class="fw-bold">EGP 750.00</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Order Totals -->
                        <div class="order-totals mt-4">
                            <div class="summary-item">
                                <span>Subtotal</span>
                                <span>EGP 2,847.00</span>
                            </div>
                            <div class="summary-item">
                                <span>Shipping</span>
                                <span>EGP 50.00</span>
                            </div>
                            <div class="summary-item">
                                <span>Tax</span>
                                <span>EGP 142.35</span>
                            </div>
                            <div class="summary-item total-row">
                                <span>Total</span>
                                <span>EGP 3,039.35</span>
                            </div>
                        </div>
                        
                        <div class="d-grid mt-4">
                            <button type="button" class="btn btn-place-order" id="place-order-btn">
                                PLACE ORDER
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Order Success Message -->
        <div class="card order-success" id="order-success">
            <div class="success-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <h3>Thank You for Your Order!</h3>
            <p class="mb-4">Your order has been placed successfully and will be processed soon.</p>
            <p class="mb-1"><strong>Order Number:</strong> <span id="order-number">FAS-12345</span></p>
            <p class="mb-4"><strong>Estimated Delivery:</strong> <span id="delivery-date">May 25, 2025</span></p>
            <button class="btn btn-primary">Continue Shopping</button>
        </div>
    </div>

    <script src="https://js.stripe.com/v3/"></script>
    <script>
        // DOM Elements
        const shippingForm = document.getElementById('shipping-form');
        const paymentOptions = document.querySelectorAll('.payment-option');
        const stripeDetails = document.getElementById('stripe-details');
        const placeOrderBtn = document.getElementById('place-order-btn');
        const paymentForm = document.getElementById('payment-form');
        const orderSuccess = document.getElementById('order-success');
        
        // Initialize Stripe - replace with your publishable key
        // This is just a test key example
        const stripe = Stripe('pk_test_TYooMQauvdEDq54NiTphI7jx');
        const elements = stripe.elements();
        // Create and mount the Stripe card Element
        const cardElement = elements.create('card');
        
        // Form Validation Function
        function validateForm() {
            let isValid = true;
            const requiredFields = shippingForm.querySelectorAll('[required]');
            
            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    field.classList.add('is-invalid');
                    isValid = false;
                } else {
                    field.classList.remove('is-invalid');
                }
            });
            
            // Validate email format
            const emailField = document.getElementById('email');
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (emailField.value && !emailRegex.test(emailField.value)) {
                emailField.classList.add('is-invalid');
                isValid = false;
            }
            
            // Validate phone format
            const phoneField = document.getElementById('phone');
            const phoneRegex = /^[0-9]{11}$/;
            if (phoneField.value && !phoneRegex.test(phoneField.value)) {
                phoneField.classList.add('is-invalid');
                isValid = false;
            }
            
            return isValid;
        }
        
        // Payment Option Selection
        paymentOptions.forEach(option => {
            option.addEventListener('click', function() {
                // Remove selected class from all options
                paymentOptions.forEach(opt => opt.classList.remove('selected'));
                
                // Add selected class to the clicked option
                this.classList.add('selected');
                
                // Check the radio button
                const radio = this.querySelector('input[type="radio"]');
                radio.checked = true;
                
                // Show/hide Stripe details
                if (radio.value === 'stripe') {
                    stripeDetails.style.display = 'block';
                    // Mount Stripe card element when selected
                    setTimeout(() => {
                        cardElement.mount('#card-element');
                    }, 100);
                } else {
                    stripeDetails.style.display = 'none';
                    cardElement.unmount();
                }
            });
        });
        
        // Listen to card element changes
        cardElement.on('change', ({error}) => {
            const displayError = document.getElementById('card-errors');
            if (error) {
                displayError.textContent = error.message;
                displayError.style.display = 'block';
            } else {
                displayError.textContent = '';
                displayError.style.display = 'none';
            }
        });
        
        // Input field validation on blur
        const inputFields = document.querySelectorAll('.form-control, .form-select');
        inputFields.forEach(field => {
            field.addEventListener('blur', function() {
                if (this.hasAttribute('required') && !this.value.trim()) {
                    this.classList.add('is-invalid');
                } else {
                    this.classList.remove('is-invalid');
                }
                
                // Special validation for email
                if (this.id === 'email') {
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (this.value && !emailRegex.test(this.value)) {
                        this.classList.add('is-invalid');
                    }
                }
                
                // Special validation for phone
                if (this.id === 'phone') {
                    const phoneRegex = /^[0-9]{11}$/;
                    if (this.value && !phoneRegex.test(this.value)) {
                        this.classList.add('is-invalid');
                    }
                }
            });
        });
        
        // Place Order Button Click
        placeOrderBtn.addEventListener('click', function() {
            if (validateForm()) {
                // Show loading state
                this.innerHTML = '<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span> Processing...';
                this.disabled = true;
                
                const selectedPayment = document.querySelector('input[name="payment"]:checked').value;
                
                if (selectedPayment === 'stripe') {
                    // Process Stripe payment
                    processStripePayment();
                } else {
                    // Simulate processing delay for non-Stripe payments
                    simulateOrderCompletion();
                }
            } else {
                // Scroll to the first invalid field
                const firstInvalid = document.querySelector('.is-invalid');
                if (firstInvalid) {
                    firstInvalid.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    firstInvalid.focus();
                }
            }
        });
        
        // Process Stripe payment
        function processStripePayment() {
            // In a real implementation, you would:
            // 1. Create a payment intent on your server
            // 2. Confirm the payment with stripe.confirmCardPayment()
            
            // Simulating a server request and payment processing
            setTimeout(() => {
                // Show success or handle errors
                simulateOrderCompletion();
            }, 2000);
        }
        
        // Simulate order completion
        function simulateOrderCompletion() {
            // Hide payment form and show success message
            paymentForm.style.display = 'none';
            orderSuccess.style.display = 'block';
            
            // Generate random order number
            const orderNumber = 'FAS-' + Math.floor(10000 + Math.random() * 90000);
            document.getElementById('order-number').textContent = orderNumber;
            
            // Calculate delivery date (7-10 days from today)
            const today = new Date();
            const deliveryDate = new Date(today);
            deliveryDate.setDate(today.getDate() + Math.floor(7 + Math.random() * 3));
            
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('delivery-date').textContent = deliveryDate.toLocaleDateString('en-US', options);
        }
    </script>
</body>
</html>